/* A parser class for Zuul 2. This will make understanding and using user input
 * easier for the sad programmer who has to develop all this. Much cake to him.
 * And Jim. Jim too.
 *
 * Author: Kyle Michel
 * Date: 01/22/2014
 */

#include <stdlib.h>
#include <string>
#include <fstream>
#include "Parser.h"
#include <cstdlib>
#include <vector>
#include <sstream>

using namespace std;
//Reads all the keywords from appropriate text files (we run a clean
//establishment) and stores them to coorisponding arrays, helping to organize
//all the possible combinations of words in the English language.
Parser::Parser() {
  currentFile.open("keywords.txt");
  if (currentFile.is_open()) {
    addToVect();
  }
}

void Parser::addToVect() {
  string line;
  while (getline(currentFile,line)) {
    vector <string> params = getParams(line);    
    for (int i = 0; i < params.size(); i++) {
      for (int j = 0; j < NUMBER_OF_CATEGORIES; j++) {
	if (params[i] == words[j][0]) {
	  words[j].push_back(line.substr(params.size()*2+1,line.length()-(params.size()*2)-1));
	}
      }
    }
  }
}

vector <string> Parser::getParams(string line) {
  int i = 0;
  vector <string> ret;
  while (line[i] != '\0') {
    if (line[i] == '@') {
      i++;
      ret.push_back(charToString(line[i]));
    }
    i++;
  }
  return ret;
}

string Parser::charToString(char c) {
  stringstream ss;
  string s;
  ss << c;
  ss >> s;
  return s;
}

bool Parser::isValidName(string test,string str) {
  vector <string> tokens;
  //split
  string word;
  stringstream ss(str);
  while (getline(ss,word,'%')) {
    tokens.push_back(word);
  }
  for(int i = 0; i < tokens.size(); i++) {
    if (test == tokens[i]) {
      return true;
    }
  }
  return false;
}

string Parser::parseCommand(string input) {

}
